From 1b7193abe207808e7c2bff7c47a0ef4c6484a3fd Mon Sep 17 00:00:00 2001
From: Chongyun Lee <licy183@termux.dev>
Date: Sun Apr 20 23:55:52 2025 +0800
Subject: [PATCH] reland jumbo 3

Enable jumbo build for the following component(s)/source_set(s):

- //net:net
- //net/dns:dns

---
 net/BUILD.gn                                     | 10 +++++++++-
 net/base/host_port_pair.cc                       |  4 ++++
 net/base/ip_endpoint.cc                          |  4 ++++
 net/disk_cache/sql/sql_backend_impl.cc           |  4 ++++
 net/dns/BUILD.gn                                 |  3 ++-
 net/dns/dns_response.cc                          |  4 ++++
 net/dns/host_cache.cc                            |  8 ++++++++
 net/dns/host_resolver_cache.cc                   |  4 ++++
 net/dns/host_resolver_dns_task.cc                |  4 ++++
 net/dns/host_resolver_internal_result.cc         |  6 ++++++
 net/dns/host_resolver_manager.cc                 |  4 ++++
 net/filter/filter_source_stream.cc               |  5 ++++-
 net/filter/gzip_source_stream.cc                 |  4 +++-
 net/http/http_cache.cc                           |  4 ++++
 net/http/http_proxy_connect_job.cc               |  4 ++++
 net/http/http_server_properties_manager.cc       |  4 ++++
 net/http/http_stream_factory_job.cc              |  4 ++++
 net/http/http_stream_factory_job_controller.cc   |  4 ++++
 net/http/transport_security_persister.cc         |  6 ++++++
 .../network_error_logging_service.cc             | 10 ++++++++++
 .../configured_proxy_resolution_service.cc       | 10 +++++++++-
 net/proxy_resolution/proxy_config_service.cc     | 10 +++++++---
 net/quic/bidirectional_stream_quic_impl.cc       |  4 ++++
 net/quic/dedicated_web_transport_http3_client.cc |  4 ++++
 net/quic/quic_chromium_client_stream.cc          |  4 ++++
 net/quic/quic_session_pool.cc                    |  4 ++++
 net/reporting/reporting_header_parser.cc         |  6 ++++++
 net/reporting/reporting_service.cc               |  6 ++++++
 net/server/web_socket_encoder.cc                 | 14 ++++++++++++++
 net/url_request/url_request_error_job.cc         |  4 ++++
 net/url_request/url_request_job.cc               |  4 ++++
 net/url_request/url_request_redirect_job.cc      |  4 ++++
 net/websockets/websocket_channel.cc              |  4 ++++
 net/websockets/websocket_frame.cc                | 16 ++++++++++++++++
 .../websocket_http2_handshake_stream.cc          |  4 ++++
 .../websocket_http3_handshake_stream.cc          |  4 ++++
 36 files changed, 194 insertions(+), 8 deletions(-)

diff --git a/net/BUILD.gn b/net/BUILD.gn
index 5bad83b0ab..4a0c80360a 100644
--- a/net/BUILD.gn
+++ b/net/BUILD.gn
@@ -7,6 +7,7 @@ import("//build/config/cast.gni")
 import("//build/config/compiler/compiler.gni")
 import("//build/config/cronet/config.gni")
 import("//build/config/features.gni")
+import("//build/config/jumbo.gni")
 import("//crypto/features.gni")
 import("//net/features.gni")
 import("//testing/libfuzzer/fuzzer_test.gni")
@@ -163,7 +164,7 @@ source_set("net_features") {
   ]
 }
 
-component("net") {
+jumbo_component("net") {
   sources = [
     "base/address_family.cc",
     "base/address_family.h",
@@ -1159,6 +1160,9 @@ component("net") {
     "url_request/websocket_handshake_userdata_key.cc",
     "url_request/websocket_handshake_userdata_key.h",
   ]
+  jumbo_excluded_sources = [
+    "spdy/spdy_stream.cc", # Fail to compile due to function name confliction
+  ]
 
   if (is_posix || is_fuchsia) {
     sources += [ "base/net_errors_posix.cc" ]
@@ -1370,6 +1374,10 @@ component("net") {
       "base/network_interfaces_linux.h",
       "base/platform_mime_util_linux.cc",
     ]
+    jumbo_excluded_sources += [
+      "base/address_tracker_linux.cc",     # Fail to compile due to the confliction between `linux/if.h` and `net/if.h`
+      "base/network_interfaces_linux.cc",  # Ditto
+    ]
   }
 
   if (is_linux) {
diff --git a/net/base/host_port_pair.cc b/net/base/host_port_pair.cc
index d5e879169b..5ba1ba77c9 100644
--- a/net/base/host_port_pair.cc
+++ b/net/base/host_port_pair.cc
@@ -20,6 +20,8 @@
 #include "url/gurl.h"
 #include "url/scheme_host_port.h"
 
+#define kValuePortKey kValuePortKey_HostPortPair
+
 namespace net {
 
 namespace {
@@ -146,3 +148,5 @@ base::Value HostPortPair::ToValue() const {
 }
 
 }  // namespace net
+
+#undef kValuePortKey
diff --git a/net/base/ip_endpoint.cc b/net/base/ip_endpoint.cc
index e6f265d0e2..442548e0a1 100644
--- a/net/base/ip_endpoint.cc
+++ b/net/base/ip_endpoint.cc
@@ -37,6 +37,8 @@
 #include <net/if.h>
 #endif
 
+#define kValuePortKey kValuePortKey_IPEndPoint
+
 namespace net {
 
 namespace {
@@ -319,3 +321,5 @@ std::ostream& operator<<(std::ostream& os, const IPEndPoint& ip_endpoint) {
 }
 
 }  // namespace net
+
+#undef kValuePortKey
diff --git a/net/disk_cache/sql/sql_backend_impl.cc b/net/disk_cache/sql/sql_backend_impl.cc
index ea80e6bde8..d0c3523a39 100644
--- a/net/disk_cache/sql/sql_backend_impl.cc
+++ b/net/disk_cache/sql/sql_backend_impl.cc
@@ -34,6 +34,8 @@
 #include "net/disk_cache/sql/sql_persistent_store.h"
 #include "sql_backend_constants.h"
 
+#define IsBrowserIdle IsBrowserIdle_SqlBackendImpl
+
 namespace disk_cache {
 namespace {
 
@@ -1460,3 +1462,5 @@ SqlBackendImpl::InFlightEntryModification::InFlightEntryModification(
     InFlightEntryModification&&) = default;
 
 }  // namespace disk_cache
+
+#undef IsBrowserIdle
diff --git a/net/dns/BUILD.gn b/net/dns/BUILD.gn
index 5ed1605df7..6ef7333108 100644
--- a/net/dns/BUILD.gn
+++ b/net/dns/BUILD.gn
@@ -2,13 +2,14 @@
 # Use of this source code is governed by a BSD-style license that can be
 # found in the LICENSE file.
 
+import("//build/config/jumbo.gni")
 import("//net/features.gni")
 import("//testing/libfuzzer/fuzzer_test.gni")
 import("//third_party/protobuf/proto_library.gni")
 
 enable_built_in_dns = use_blink
 
-source_set("dns") {
+jumbo_source_set("dns") {
   # Due to circular dependencies, should only be depended on through //net.
   visibility = [
     "//net",
diff --git a/net/dns/dns_response.cc b/net/dns/dns_response.cc
index 8337d29349..18ecc9bbef 100644
--- a/net/dns/dns_response.cc
+++ b/net/dns/dns_response.cc
@@ -34,6 +34,8 @@
 #include "net/dns/public/dns_protocol.h"
 #include "net/dns/record_rdata.h"
 
+#define kHeaderSize kHeaderSize_DnsResponse
+
 namespace net {
 
 namespace {
@@ -653,3 +655,5 @@ bool DnsResponse::WriteAnswer(base::SpanWriter<uint8_t>* writer,
 }
 
 }  // namespace net
+
+#undef kHeaderSize
diff --git a/net/dns/host_cache.cc b/net/dns/host_cache.cc
index 625c036283..db0f8ade85 100644
--- a/net/dns/host_cache.cc
+++ b/net/dns/host_cache.cc
@@ -44,6 +44,10 @@
 #include "net/log/net_log.h"
 #include "url/scheme_host_port.h"
 
+#define kSecureKey                    kSecureKey_HostCache
+#define EndpointMetadataPairToValue   EndpointMetadataPairToValue_HostCache
+#define EndpointMetadataPairFromValue EndpointMetadataPairFromValue_HostCache
+
 namespace net {
 
 namespace {
@@ -1319,3 +1323,7 @@ std::ostream& operator<<(std::ostream& out,
   return out << "EntryStaleness{" << s.expired_by << ", " << s.network_changes
              << ", " << s.stale_hits << "}";
 }
+
+#undef kSecureKey
+#undef EndpointMetadataPairToValue
+#undef EndpointMetadataPairFromValue
diff --git a/net/dns/host_resolver_cache.cc b/net/dns/host_resolver_cache.cc
index fbdc86061d..d1bc940e4c 100644
--- a/net/dns/host_resolver_cache.cc
+++ b/net/dns/host_resolver_cache.cc
@@ -24,6 +24,8 @@
 #include "url/url_canon.h"
 #include "url/url_canon_stdstring.h"
 
+#define kSecureKey kSecureKey_HostResolverCache
+
 namespace net {
 
 namespace {
@@ -452,3 +454,5 @@ base::Value HostResolverCache::SerializeEntries(
 }
 
 }  // namespace net
+
+#undef kSecureKey
diff --git a/net/dns/host_resolver_dns_task.cc b/net/dns/host_resolver_dns_task.cc
index 4cb7683cb6..7eb5ccab01 100644
--- a/net/dns/host_resolver_dns_task.cc
+++ b/net/dns/host_resolver_dns_task.cc
@@ -25,6 +25,8 @@
 #include "net/dns/host_resolver_internal_result.h"
 #include "net/dns/public/util.h"
 
+#define NetLogResults NetLogResults_HostResolverDnsTask
+
 namespace net {
 
 // When enabled, query HTTPS RR first.
@@ -1177,3 +1179,5 @@ bool HostResolverDnsTask::ShouldTriggerHttpToHttpsUpgrade(
 }
 
 }  // namespace net
+
+#undef NetLogResults
diff --git a/net/dns/host_resolver_internal_result.cc b/net/dns/host_resolver_internal_result.cc
index 94d0b6b220..87ca75ff69 100644
--- a/net/dns/host_resolver_internal_result.cc
+++ b/net/dns/host_resolver_internal_result.cc
@@ -27,6 +27,9 @@
 #include "url/url_canon.h"
 #include "url/url_canon_stdstring.h"
 
+#define EndpointMetadataPairToValue   EndpointMetadataPairToValue_HostResolverInternalResult
+#define EndpointMetadataPairFromValue EndpointMetadataPairFromValue_HostResolverInternalResult
+
 namespace net {
 
 namespace {
@@ -634,3 +637,6 @@ HostResolverInternalAliasResult::HostResolverInternalAliasResult(
       alias_target_(MaybeCanonicalizeName(std::move(alias_target))) {}
 
 }  // namespace net
+
+#undef EndpointMetadataPairToValue
+#undef EndpointMetadataPairFromValue
diff --git a/net/dns/host_resolver_manager.cc b/net/dns/host_resolver_manager.cc
index 1bd1929b69..f21aba5eaf 100644
--- a/net/dns/host_resolver_manager.cc
+++ b/net/dns/host_resolver_manager.cc
@@ -139,6 +139,8 @@
 #endif  // BUILDFLAG(IS_ANDROID)
 #endif  // BUILDFLAG(IS_POSIX) || BUILDFLAG(IS_FUCHSIA)
 
+#define NetLogResults NetLogResults_HostResolverManager
+
 namespace net {
 
 namespace {
@@ -1839,3 +1841,5 @@ std::unique_ptr<DnsProbeRunner> HostResolverManager::CreateDohProbeRunner(
 }
 
 }  // namespace net
+
+#undef NetLogResults
diff --git a/net/filter/filter_source_stream.cc b/net/filter/filter_source_stream.cc
index 076141503b..dbc2fa60fb 100644
--- a/net/filter/filter_source_stream.cc
+++ b/net/filter/filter_source_stream.cc
@@ -29,7 +29,7 @@
 
 namespace net {
 
-namespace {
+namespace filter_source_stream {
 
 constexpr char kDeflate[] = "deflate";
 constexpr char kGZip[] = "gzip";
@@ -52,6 +52,7 @@ FilterSourceStream::~FilterSourceStream() = default;
 int FilterSourceStream::Read(IOBuffer* read_buffer,
                              int read_buffer_size,
                              CompletionOnceCallback callback) {
+  using namespace filter_source_stream;
   DCHECK_EQ(STATE_NONE, next_state_);
   DCHECK(read_buffer);
   DCHECK_LT(0, read_buffer_size);
@@ -89,6 +90,7 @@ bool FilterSourceStream::MayHaveMoreBytes() const {
 
 SourceStreamType FilterSourceStream::ParseEncodingType(
     std::string_view encoding) {
+  using namespace filter_source_stream;
   std::string lower_encoding = base::ToLowerASCII(encoding);
   static constexpr auto kEncodingMap =
       base::MakeFixedFlatMap<std::string_view, SourceStreamType>({
@@ -202,6 +204,7 @@ int FilterSourceStream::DoLoop(int result) {
 }
 
 int FilterSourceStream::DoReadData() {
+  using namespace filter_source_stream;
   // Read more data means subclasses have consumed all input or this is the
   // first read in which case the |drainable_input_buffer_| is not initialized.
   DCHECK(drainable_input_buffer_ == nullptr ||
diff --git a/net/filter/gzip_source_stream.cc b/net/filter/gzip_source_stream.cc
index f25eed8ac6..2c325feebd 100644
--- a/net/filter/gzip_source_stream.cc
+++ b/net/filter/gzip_source_stream.cc
@@ -26,7 +26,7 @@
 
 namespace net {
 
-namespace {
+namespace gzip_source_stream {
 
 const char kDeflate[] = "DEFLATE";
 const char kGzip[] = "GZIP";
@@ -77,6 +77,7 @@ bool GzipSourceStream::Init() {
 }
 
 std::string GzipSourceStream::GetTypeAsString() const {
+  using namespace gzip_source_stream;
   switch (type()) {
     case SourceStreamType::kGzip:
       return kGzip;
@@ -94,6 +95,7 @@ base::expected<size_t, Error> GzipSourceStream::FilterData(
     size_t input_buffer_size,
     size_t* consumed_bytes,
     bool upstream_end_reached) {
+  using namespace gzip_source_stream;
   *consumed_bytes = 0;
 
   // Span that tracks the portion of `input_buffer` that has not yet been
diff --git a/net/http/http_cache.cc b/net/http/http_cache.cc
index a50e7a6fbd..06ef5830ee 100644
--- a/net/http/http_cache.cc
+++ b/net/http/http_cache.cc
@@ -65,6 +65,8 @@
 #include <unistd.h>
 #endif
 
+#define TaskRunner TaskRunner_HttpCache
+
 namespace net {
 
 namespace {
@@ -1774,3 +1776,5 @@ void HttpCache::OnNoVarySearchCacheLoadComplete(
 }
 
 }  // namespace net
+
+#undef TaskRunner
diff --git a/net/http/http_proxy_connect_job.cc b/net/http/http_proxy_connect_job.cc
index e22baea14b..1e3fa15866 100644
--- a/net/http/http_proxy_connect_job.cc
+++ b/net/http/http_proxy_connect_job.cc
@@ -54,6 +54,8 @@
 #include "url/gurl.h"
 #include "url/scheme_host_port.h"
 
+#define TaskRunner TaskRunner_HttpProxyConnectJob
+
 namespace net {
 
 namespace {
@@ -1003,3 +1005,5 @@ void HttpProxyConnectJob::EmitConnectLatency(NextProto http_version,
 }
 
 }  // namespace net
+
+#undef TaskRunner
diff --git a/net/http/http_server_properties_manager.cc b/net/http/http_server_properties_manager.cc
index 9340c13447..357fefc50a 100644
--- a/net/http/http_server_properties_manager.cc
+++ b/net/http/http_server_properties_manager.cc
@@ -29,6 +29,8 @@
 #include "url/gurl.h"
 #include "url/scheme_host_port.h"
 
+#define kVersionKey kVersionKey_HTTPServerPropertiesManager
+
 namespace net {
 
 namespace {
@@ -1011,3 +1013,5 @@ void HttpServerPropertiesManager::OnHttpServerPropertiesLoaded() {
 }
 
 }  // namespace net
+
+#undef kVersionKey
diff --git a/net/http/http_stream_factory_job.cc b/net/http/http_stream_factory_job.cc
index 1e7c2bf349..238bf28cfe 100644
--- a/net/http/http_stream_factory_job.cc
+++ b/net/http/http_stream_factory_job.cc
@@ -58,6 +58,8 @@
 #include "url/scheme_host_port.h"
 #include "url/url_constants.h"
 
+#define TaskRunner TaskRunner_HttpStreamFactoryJob
+
 namespace net {
 
 namespace {
@@ -1387,3 +1389,5 @@ void HttpStreamFactory::Job::RecordCompletionHistograms(int result) {
 }
 
 }  // namespace net
+
+#undef TaskRunner
diff --git a/net/http/http_stream_factory_job_controller.cc b/net/http/http_stream_factory_job_controller.cc
index 0e85e3884f..0f144f96a1 100644
--- a/net/http/http_stream_factory_job_controller.cc
+++ b/net/http/http_stream_factory_job_controller.cc
@@ -49,6 +49,8 @@
 #include "url/scheme_host_port.h"
 #include "url/url_constants.h"
 
+#define TaskRunner TaskRunner_HttpStreamFactoryJobController
+
 namespace net {
 
 namespace {
@@ -1590,3 +1592,5 @@ void HttpStreamFactory::JobController::NotifyOnStreamCreationAttempted(
 }
 
 }  // namespace net
+
+#undef TaskRunner
diff --git a/net/http/transport_security_persister.cc b/net/http/transport_security_persister.cc
index 377125a4ba..c52a3bca9e 100644
--- a/net/http/transport_security_persister.cc
+++ b/net/http/transport_security_persister.cc
@@ -30,6 +30,9 @@
 #include "net/cert/x509_certificate.h"
 #include "net/http/transport_security_state.h"
 
+#define kVersionKey kVersionKey_TransportSecurityPersister
+#define LoadState   LoadState_TransportSecurityPersister
+
 namespace net {
 
 BASE_FEATURE(kTransportSecurityFileWriterSchedule,
@@ -322,3 +325,6 @@ void TransportSecurityPersister::CompleteLoad(const std::string& state) {
 }
 
 }  // namespace net
+
+#undef kVersionKey
+#undef LoadState
diff --git a/net/network_error_logging/network_error_logging_service.cc b/net/network_error_logging/network_error_logging_service.cc
index 6cfb23ce25..6fb6719545 100644
--- a/net/network_error_logging/network_error_logging_service.cc
+++ b/net/network_error_logging/network_error_logging_service.cc
@@ -34,6 +34,11 @@
 #include "url/gurl.h"
 #include "url/origin.h"
 
+#define kIncludeSubdomainsKey kIncludeSubdomainsKey_NetworkErrorLoggingService
+#define kMaxAgeKey            kMaxAgeKey_NetworkErrorLoggingService
+#define kMaxJsonSize          kMaxJsonSize_NetworkErrorLoggingService
+#define kMaxJsonDepth         kMaxJsonDepth_NetworkErrorLoggingService
+
 namespace net {
 
 namespace {
@@ -1064,3 +1069,8 @@ NetworkErrorLoggingService::NetworkErrorLoggingService()
     : clock_(base::DefaultClock::GetInstance()) {}
 
 }  // namespace net
+
+#undef kIncludeSubdomainsKey
+#undef kMaxAgeKey
+#undef kMaxJsonSize
+#undef kMaxJsonDepth
diff --git a/net/proxy_resolution/configured_proxy_resolution_service.cc b/net/proxy_resolution/configured_proxy_resolution_service.cc
index a479677c25..4cce105059 100644
--- a/net/proxy_resolution/configured_proxy_resolution_service.cc
+++ b/net/proxy_resolution/configured_proxy_resolution_service.cc
@@ -162,6 +162,10 @@ class DefaultPollPolicy
   }
 };
 
+}  // namespace
+
+namespace configured_proxy_resolution_service {
+
 // Config getter that always returns direct settings.
 class ProxyConfigServiceDirect : public ProxyConfigService {
  public:
@@ -175,6 +179,10 @@ class ProxyConfigServiceDirect : public ProxyConfigService {
   }
 };
 
+}  // namespace configured_proxy_resolution_service
+
+namespace {
+
 // Proxy resolver that fails every time.
 class ProxyResolverNull : public ProxyResolver {
  public:
@@ -889,7 +897,7 @@ std::unique_ptr<ConfiguredProxyResolutionService>
 ConfiguredProxyResolutionService::CreateDirect() {
   // Use direct connections.
   return std::make_unique<ConfiguredProxyResolutionService>(
-      std::make_unique<ProxyConfigServiceDirect>(),
+      std::make_unique<configured_proxy_resolution_service::ProxyConfigServiceDirect>(),
       std::make_unique<ProxyResolverFactoryForNullResolver>(), nullptr,
       /*quick_check_enabled=*/true);
 }
diff --git a/net/proxy_resolution/proxy_config_service.cc b/net/proxy_resolution/proxy_config_service.cc
index e32f7dd46b..25c271441b 100644
--- a/net/proxy_resolution/proxy_config_service.cc
+++ b/net/proxy_resolution/proxy_config_service.cc
@@ -75,6 +75,10 @@ class UnsetProxyConfigService : public ProxyConfigService {
 };
 #endif
 
+}  // namespace
+
+namespace proxy_config_service {
+
 // Config getter that always returns direct settings.
 class ProxyConfigServiceDirect : public ProxyConfigService {
  public:
@@ -88,7 +92,7 @@ class ProxyConfigServiceDirect : public ProxyConfigService {
   }
 };
 
-}  // namespace
+}  // namespace proxy_config_service
 
 // static
 std::unique_ptr<ProxyConfigService>
@@ -133,11 +137,11 @@ ProxyConfigService::CreateSystemProxyConfigService(
       base::SingleThreadTaskRunner::GetCurrentDefault());
 #elif BUILDFLAG(IS_FUCHSIA)
   // TODO(crbug.com/42050626): Implement a system proxy service for Fuchsia.
-  return std::make_unique<ProxyConfigServiceDirect>();
+  return std::make_unique<proxy_config_service::ProxyConfigServiceDirect>();
 #else
   LOG(WARNING) << "Failed to choose a system proxy settings fetcher "
                   "for this platform.";
-  return std::make_unique<ProxyConfigServiceDirect>();
+  return std::make_unique<proxy_config_service::ProxyConfigServiceDirect>();
 #endif
 }
 
diff --git a/net/quic/bidirectional_stream_quic_impl.cc b/net/quic/bidirectional_stream_quic_impl.cc
index 83bf267ae0..141591c353 100644
--- a/net/quic/bidirectional_stream_quic_impl.cc
+++ b/net/quic/bidirectional_stream_quic_impl.cc
@@ -19,6 +19,8 @@
 #include "net/third_party/quiche/src/quiche/quic/core/quic_connection.h"
 #include "quic_http_stream.h"
 
+#define ScopedBoolSaver ScopedBoolSaver_BidirectionalStreamQuicImpl
+
 namespace net {
 namespace {
 // Sets a boolean to a value, and restores it to the previous value once
@@ -408,3 +410,5 @@ void BidirectionalStreamQuicImpl::ResetStream() {
 }
 
 }  // namespace net
+
+#undef ScopedBoolSaver
diff --git a/net/quic/dedicated_web_transport_http3_client.cc b/net/quic/dedicated_web_transport_http3_client.cc
index b7e45bfefa..6b0f4225ce 100644
--- a/net/quic/dedicated_web_transport_http3_client.cc
+++ b/net/quic/dedicated_web_transport_http3_client.cc
@@ -32,6 +32,8 @@
 #include "net/url_request/url_request_context.h"
 #include "url/scheme_host_port.h"
 
+#define HostsFromOrigins HostsFromOrigins_DedicatedWebTransportHTTP3Client
+
 namespace net {
 
 namespace {
@@ -1027,3 +1029,5 @@ void DedicatedWebTransportHttp3Client::OnDatagramProcessed(
 }
 
 }  // namespace net
+
+#undef HostsFromOrigins
diff --git a/net/quic/quic_chromium_client_stream.cc b/net/quic/quic_chromium_client_stream.cc
index 7567aca83b..77e8d96efb 100644
--- a/net/quic/quic_chromium_client_stream.cc
+++ b/net/quic/quic_chromium_client_stream.cc
@@ -30,6 +30,8 @@
 #include "net/third_party/quiche/src/quiche/quic/core/quic_utils.h"
 #include "net/third_party/quiche/src/quiche/quic/core/quic_write_blocked_list.h"
 
+#define ScopedBoolSaver ScopedBoolSaver_QuicChromiumClientStream
+
 namespace net {
 namespace {
 // Sets a boolean to a value, and restores it to the previous value once
@@ -929,3 +931,5 @@ bool QuicChromiumClientStream::IsFirstStream() {
 }
 
 }  // namespace net
+
+#undef ScopedBoolSaver
diff --git a/net/quic/quic_session_pool.cc b/net/quic/quic_session_pool.cc
index fb479b568e..db7713d89d 100644
--- a/net/quic/quic_session_pool.cc
+++ b/net/quic/quic_session_pool.cc
@@ -93,6 +93,8 @@
 #include "url/scheme_host_port.h"
 #include "url/url_constants.h"
 
+#define HostsFromOrigins HostsFromOrigins_QuicSessionPool
+
 namespace net {
 
 namespace {
@@ -2508,3 +2510,5 @@ bool QuicSessionPool::CryptoConfigCacheIsEmptyForTesting(
 }
 
 }  // namespace net
+
+#undef HostsFromOrigins
diff --git a/net/reporting/reporting_header_parser.cc b/net/reporting/reporting_header_parser.cc
index 7d57516e73..4276f0fe58 100644
--- a/net/reporting/reporting_header_parser.cc
+++ b/net/reporting/reporting_header_parser.cc
@@ -25,6 +25,9 @@
 #include "net/reporting/reporting_endpoint.h"
 #include "net/reporting/reporting_target_type.h"
 
+#define kIncludeSubdomainsKey kIncludeSubdomainsKey_ReportingHeaderParser
+#define kMaxAgeKey            kMaxAgeKey_ReportingHeaderParser
+
 namespace net {
 
 namespace {
@@ -375,3 +378,6 @@ void ReportingHeaderParser::ProcessParsedReportingEndpointsHeader(
 }
 
 }  // namespace net
+
+#undef kIncludeSubdomainsKey
+#undef kMaxAgeKey
diff --git a/net/reporting/reporting_service.cc b/net/reporting/reporting_service.cc
index 8daacdc85d..4171afe33e 100644
--- a/net/reporting/reporting_service.cc
+++ b/net/reporting/reporting_service.cc
@@ -30,6 +30,9 @@
 #include "url/gurl.h"
 #include "url/origin.h"
 
+#define kMaxJsonSize  kMaxJsonSize_ReportingService
+#define kMaxJsonDepth kMaxJsonDepth_ReportingService
+
 namespace net {
 
 namespace {
@@ -370,3 +373,6 @@ base::Value ReportingService::StatusAsValue() const {
 }
 
 }  // namespace net
+
+#undef kMaxJsonSize
+#undef kMaxJsonDepth
diff --git a/net/server/web_socket_encoder.cc b/net/server/web_socket_encoder.cc
index 569dc3587c..d7cd5945d1 100644
--- a/net/server/web_socket_encoder.cc
+++ b/net/server/web_socket_encoder.cc
@@ -23,6 +23,13 @@
 #include "net/websockets/websocket_extension_parser.h"
 #include "net/websockets/websocket_frame.h"
 
+#define kFinalBit     kFinalBit_WebSocketEncoder
+#define kReserved1Bit kReserved1Bit_WebSocketEncoder
+#define kReserved2Bit kReserved2Bit_WebSocketEncoder
+#define kReserved3Bit kReserved3Bit_WebSocketEncoder
+#define kOpCodeMask   kOpCodeMask_WebSocketEncoder
+#define kMaskBit      kMaskBit_WebSocketEncoder
+
 namespace net {
 
 NET_EXPORT
@@ -409,3 +416,10 @@ bool WebSocketEncoder::Deflate(std::string_view message, std::string* output) {
 }
 
 }  // namespace net
+
+#undef kFinalBit
+#undef kReserved1Bit
+#undef kReserved2Bit
+#undef kReserved3Bit
+#undef kOpCodeMask
+#undef kMaskBit
diff --git a/net/url_request/url_request_error_job.cc b/net/url_request/url_request_error_job.cc
index 6d9a7d4394..5f58a96b9c 100644
--- a/net/url_request/url_request_error_job.cc
+++ b/net/url_request/url_request_error_job.cc
@@ -12,6 +12,8 @@
 #include "net/base/net_errors.h"
 #include "net/base/task/task_runner.h"
 
+#define TaskRunner TaskRunner_URLRequestErrorJob
+
 namespace net {
 
 namespace {
@@ -46,3 +48,5 @@ void URLRequestErrorJob::StartAsync() {
 }
 
 }  // namespace net
+
+#undef TaskRunner
diff --git a/net/url_request/url_request_job.cc b/net/url_request/url_request_job.cc
index f65b7e6ecc..62debd054f 100644
--- a/net/url_request/url_request_job.cc
+++ b/net/url_request/url_request_job.cc
@@ -40,6 +40,8 @@
 #include "net/url_request/redirect_util.h"
 #include "net/url_request/url_request_context.h"
 
+#define TaskRunner TaskRunner_URLRequestJob
+
 namespace net {
 
 namespace {
@@ -777,3 +779,5 @@ void URLRequestJob::RecordBytesRead(int bytes_read) {
 }
 
 }  // namespace net
+
+#undef TaskRunner
diff --git a/net/url_request/url_request_redirect_job.cc b/net/url_request/url_request_redirect_job.cc
index 270cbfcf40..19f5805390 100644
--- a/net/url_request/url_request_redirect_job.cc
+++ b/net/url_request/url_request_redirect_job.cc
@@ -27,6 +27,8 @@
 #include "net/url_request/url_request.h"
 #include "net/url_request/url_request_job.h"
 
+#define TaskRunner TaskRunner_URLRequestRedirectJob
+
 namespace net {
 
 namespace {
@@ -117,3 +119,5 @@ void URLRequestRedirectJob::StartAsync() {
 }
 
 }  // namespace net
+
+#undef TaskRunner
diff --git a/net/websockets/websocket_channel.cc b/net/websockets/websocket_channel.cc
index 576e57de2f..793cc64953 100644
--- a/net/websockets/websocket_channel.cc
+++ b/net/websockets/websocket_channel.cc
@@ -43,6 +43,8 @@
 #include "net/websockets/websocket_handshake_response_info.h"
 #include "net/websockets/websocket_stream.h"
 
+#define kWebSocketCloseCodeLength kWebSocketCloseCodeLength_WebSocketChannel
+
 namespace net {
 class AuthChallengeInfo;
 class AuthCredentials;
@@ -985,3 +987,5 @@ void WebSocketChannel::CloseTimeout() {
 }
 
 }  // namespace net
+
+#undef kWebSocketCloseCodeLength
diff --git a/net/websockets/websocket_frame.cc b/net/websockets/websocket_frame.cc
index 59fdd30682..0c3c8207d9 100644
--- a/net/websockets/websocket_frame.cc
+++ b/net/websockets/websocket_frame.cc
@@ -22,6 +22,14 @@
 #include "net/base/net_errors.h"
 #include "net/websockets/websocket_errors.h"
 
+#define kWebSocketCloseCodeLength kWebSocketCloseCodeLength_WebSocketFrame
+#define kFinalBit                 kFinalBit_WebSocketFrame
+#define kReserved1Bit             kReserved1Bit_WebSocketFrame
+#define kReserved2Bit             kReserved2Bit_WebSocketFrame
+#define kReserved3Bit             kReserved3Bit_WebSocketFrame
+#define kOpCodeMask               kOpCodeMask_WebSocketFrame
+#define kMaskBit                  kMaskBit_WebSocketFrame
+
 namespace net {
 
 namespace {
@@ -308,3 +316,11 @@ ParseCloseFrameResult ParseCloseFrame(base::span<const char> payload) {
 }
 
 }  // namespace net
+
+#undef kWebSocketCloseCodeLength
+#undef kFinalBit
+#undef kReserved1Bit
+#undef kReserved2Bit
+#undef kReserved3Bit
+#undef kOpCodeMask
+#undef kMaskBit
diff --git a/net/websockets/websocket_http2_handshake_stream.cc b/net/websockets/websocket_http2_handshake_stream.cc
index 2ee6bcf5e2..f6507e45aa 100644
--- a/net/websockets/websocket_http2_handshake_stream.cc
+++ b/net/websockets/websocket_http2_handshake_stream.cc
@@ -34,6 +34,8 @@
 #include "net/websockets/websocket_handshake_constants.h"
 #include "net/websockets/websocket_handshake_request_info.h"
 
+#define ValidateStatus ValidateStatus_WebSocketHttp2HandshakeStream
+
 namespace net {
 
 namespace {
@@ -419,3 +421,5 @@ void WebSocketHttp2HandshakeStream::OnFailure(
 }
 
 }  // namespace net
+
+#undef ValidateStatus
diff --git a/net/websockets/websocket_http3_handshake_stream.cc b/net/websockets/websocket_http3_handshake_stream.cc
index 41ba26fe48..55f5657768 100644
--- a/net/websockets/websocket_http3_handshake_stream.cc
+++ b/net/websockets/websocket_http3_handshake_stream.cc
@@ -29,6 +29,8 @@
 #include "net/websockets/websocket_handshake_constants.h"
 #include "net/websockets/websocket_handshake_request_info.h"
 
+#define ValidateStatus ValidateStatus_WebSocketHttp3HandshakeStream
+
 namespace net {
 struct AlternativeService;
 
@@ -401,3 +403,5 @@ void WebSocketHttp3HandshakeStream::OnFailure(
 }
 
 }  // namespace net
+
+#undef ValidateStatus
