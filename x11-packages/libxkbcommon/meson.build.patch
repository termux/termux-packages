# Partially reverts https://github.com/xkbcommon/libxkbcommon/commit/227995625d3f16afad587ceb1a4e3817a4586846
# Programs can not be run while cross compiling

--- a/meson.build
+++ b/meson.build
@@ -186,20 +186,7 @@
     endif
 endif
 if cc.has_header_symbol('locale.h', 'newlocale', prefix: system_ext_define)
-    # Use newlocale only if it fails on missing locales
-    r = cc.run(
-        '''
-        #define _GNU_SOURCE
-        #include <locale.h>
-        int main(void){
-            locale_t loc = newlocale(LC_ALL_MASK, "Â¡NONSENSE!", (locale_t) 0);
-            return (loc != (locale_t) 0);
-        }''',
-        name: 'newlocale fails on invalid locales',
-    )
-    if r.compiled() and r.returncode() == 0
-        configh_data.set('HAVE_NEWLOCALE', 1)
-    endif
+    configh_data.set('HAVE_NEWLOCALE', 1)
 endif
 
 # Silence some security & deprecation warnings on MSVC
